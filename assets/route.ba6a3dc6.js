import"./modulepreload-polyfill.c7c6310f.js";const D=new URLSearchParams(window.location.search),$=`${D.get("fname")}.json`,B=D.get("car_id");console.log(`fname: ${$}`);console.log(`carID : ${B}`);async function O(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`JSON \uC77D\uAE30 \uC624\uB958: ${t.status} ${t.statusText}`);return(await t.json()).result.filter(n=>n.CAR_NUM===B).map(n=>{const{VISIT_ORDER:c,Y:i,X:o,ZIP_CODE:s,ADDRESS_FULL:u,OPEN_TIME:p,CLOSE_TIME:a,ORDER_VOLUME:m,BOX_NUM:C,OPT_ARR_TIME_HM:l,EST_PROC_TIME:d}=n,g=parseInt(c),_=parseFloat(i),f=parseFloat(o),E=s,I=u,w=N(parseInt(p)),v=H(parseInt(a)),y=parseFloat(m),L=parseInt(C),R=l,k=parseInt(d);return{visit_order:g,latitude:_,longitude:f,zip_code:E,address:I,open_time:w,close_time:v,order_volume:y,box_num:L,arrival_time:R,dwell_time:k}})}catch(t){return console.error("JSON \uC77D\uAE30 \uC624\uB958:",t),[]}}async function x(){const e=new google.maps.Map(document.getElementById("map"),{zoom:4}),t=new google.maps.InfoWindow,r=[];try{const n=await O(`/singpost/data/input-data/${$}`);n.length>0?A(n,e,t,r):console.error("\uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.")}catch(n){console.error("\uB370\uC774\uD130 \uB85C\uB529 \uC624\uB958:",n)}}function A(e,t,r,n){var c=e.map(function(a){return a.longitude}),i=e.map(function(a){return a.latitude});t.fitBounds({west:Math.min.apply(null,c),east:Math.max.apply(null,c),north:Math.min.apply(null,i),south:Math.max.apply(null,i)});for(var o=0,s=[],u=25-1;o<e.length;o=o+u)s.push(e.slice(o,o+u+1));const p=new google.maps.DirectionsService;e.slice(1,e.length-1).forEach(a=>{new google.maps.LatLng(a.latitude,a.longitude)});for(var o=0;o<s.length;o++){const m=[];s[o].slice(1,e.length-1).forEach(l=>{const d={location:new google.maps.LatLng(l.latitude,l.longitude)};m.push(d)});const C={origin:{lat:s[o][0].latitude,lng:s[o][0].longitude},destination:{lat:s[o][s[o].length-1].latitude,lng:s[o][s[o].length-1].longitude},waypoints:m,travelMode:google.maps.TravelMode.DRIVING,avoidTolls:!0};p.route(C,(l,d)=>{if(d===google.maps.DirectionsStatus.OK&&l){var g=new google.maps.DirectionsRenderer;g.setMap(t),g.setOptions({suppressMarkers:!0,preserveViewport:!0}),g.setDirections(l);var _=new google.maps.DirectionsRenderer({draggable:!1,map:t,suppressMarkers:!1,preserveViewport:!0,suppressInfoWindows:!0,markerOptions:{icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"white",fillOpacity:1,strokeWeight:3,strokeColor:"blue",scale:5},zIndex:0}});_.addListener("directions_changed",()=>{const f=_.getDirections();f&&z(f)}),_.setDirections(l),e.forEach((f,E)=>{const I=E+1+"",w=S(e[E].arrival_time),v=F(e,I,E,t,w),y=T(f);n.push(v),v.addListener("click",()=>{r.setContent(y),r.open(t,v)})}),U(e,t,r,n)}else console.error("index: ",o),console.error("parts: ",s),console.error("\uACBD\uB85C \uC694\uCCAD \uC2E4\uD328:",d)})}}function F(e,t,r,n,c){const i=r===0?e.length:e.length-r;return new google.maps.Marker({position:new google.maps.LatLng(e[r].latitude,e[r].longitude),map:n,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:c,fillOpacity:1,strokeWeight:2,scale:10},label:{text:t},zIndex:i})}function S(e){const t=parseInt(e.split(":")[0]);return t>=0&&t<=11?"red":t>=12&&t<=14?"orange":t>=15&&t<=17?"yellow":"#3ADF00"}function N(e){const t=Math.floor(e/60),r=e%60;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function H(e){if(e>=1440)return"23:59";{const t=Math.floor(e/60),r=e%60;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}}function T(e){return`
  <strong>- Zipcode: </strong>${e.zip_code}<br>
  <strong>- Address: </strong>${e.address}<br>
  <strong>- Arrival Time: </strong>${e.arrival_time}<br>
  <strong>- Dwell Time: </strong>${e.dwell_time}<br>
  <strong>- Items: </strong>${e.box_num}<br>
  <strong>- Total Weight: </strong>${e.order_volume}<br>
  <strong>- Requested time from: </strong>${e.open_time}<br>
  <strong>- Requested time to: </strong>${e.close_time}<br>
  `}function P(e){return`
  (${e.zip_code})<br>
  ${e.address}<br>
  `}function q(e){return`
  - Arrival Time: ${e.arrival_time}<br>
  - Dwell Time: ${e.dwell_time}<br>
  - Items: ${e.box_num}<br>
  - Total Weight: ${e.order_volume}<br>
  - Requested time from: ${e.open_time}<br>
  - Requested time to: ${e.close_time}<br>
  `}function z(e){let t=0;const r=e.routes[0];if(!!r){for(let n=0;n<r.legs.length;n++)t+=r.legs[n].distance.value;t=t/1e3,document.getElementById("total").innerHTML=t+" km"}}function U(e,t,r,n){const c=document.getElementById("data-list");c&&(c.innerHTML="",e.forEach(i=>{const o=document.createElement("li");o.className="data-item";const s=document.createElement("div");s.className="item-header";const u=document.createElement("div");u.className="index-circle",u.style.backgroundColor=S(e[i.visit_order].arrival_time);const p=document.createElement("span");p.textContent=(i.visit_order+1).toString(),u.appendChild(p);const a=document.createElement("div");a.className="header-info",a.innerHTML=P(i),s.appendChild(u),s.appendChild(a),o.appendChild(s);const m=document.createElement("div");m.innerHTML=q(i),o.appendChild(m),c.appendChild(o),s.addEventListener("click",()=>{const C=i.visit_order,l=n[C];l&&(n.forEach((d,g)=>{d.setZIndex(n.length-g)}),l.setZIndex(n.length+1),r.setContent(T(i)),r.open(t,l))})}))}const b=document.getElementById("accordian-header"),M=document.querySelector(".arrow-icon"),h=document.getElementById("sidebar");if(b&&M&&h){let e=!1;b.addEventListener("click",()=>{e?(h.style.maxHeight="0",h.addEventListener("transitionend",()=>{h.style.padding="0"},{once:!0})):(h.style.maxHeight="50%",h.style.padding="1rem"),e=!e,M.style.transform=e?"rotate(180deg)":"rotate(0deg)"})}else console.error("Required elements not found");window.initMap=x;
