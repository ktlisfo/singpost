import"./modulepreload-polyfill.c7c6310f.js";const B=new URLSearchParams(window.location.search),D=`${B.get("fname")}.json`,S=B.get("car_id");console.log(`fname: ${D}`);console.log(`carID : ${S}`);async function P(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`JSON \uC77D\uAE30 \uC624\uB958: ${t.status} ${t.statusText}`);return(await t.json()).result.filter(o=>o.CAR_NUM===S).map(o=>{const{VISIT_ORDER:l,Y:i,X:n,ZIP_CODE:s,ADDRESS_FULL:a,OPEN_TIME:m,CLOSE_TIME:u,ORDER_VOLUME:g,BOX_NUM:p,OPT_ARR_TIME_HM:c,EST_PROC_TIME:d,NM_COUNT:f,BOX_COUNT:h,E:C}=o,I=parseInt(l),w=parseFloat(i),v=parseFloat(n),_=s,y=a,k=V(parseInt(m)),O=j(parseInt(u)),$=parseFloat(g),R=parseInt(p),F=c,N=parseInt(d),x=parseInt(f),A=parseInt(h),H=parseInt(C);return{visit_order:I,latitude:w,longitude:v,zip_code:_,address:y,open_time:k,close_time:O,order_volume:$,box_num:R,arrival_time:F,dwell_time:N,nm_count:x,box_count:A,e:H}})}catch(t){return console.error("JSON \uC77D\uAE30 \uC624\uB958:",t),[]}}async function U(){const e=new google.maps.Map(document.getElementById("map"),{zoom:4}),t=new google.maps.InfoWindow,r=[];try{const o=await P(`/singpost/data/input-data/${D}`);o.length>0?z(o,e,t,r):console.error("\uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.")}catch(o){console.error("\uB370\uC774\uD130 \uB85C\uB529 \uC624\uB958:",o)}}function z(e,t,r,o){var l=e.map(function(u){return u.longitude}),i=e.map(function(u){return u.latitude});t.fitBounds({west:Math.min.apply(null,l),east:Math.max.apply(null,l),north:Math.min.apply(null,i),south:Math.max.apply(null,i)});for(var n=0,s=[],a=25-1;n<e.length;n=n+a)s.push(e.slice(n,n+a+1));const m=new google.maps.DirectionsService;e.slice(1,e.length-1).forEach(u=>{new google.maps.LatLng(u.latitude,u.longitude)});for(var n=0;n<s.length;n++){const g=[];s[n].slice(1,e.length-1).forEach(c=>{const d={location:new google.maps.LatLng(c.latitude,c.longitude)};g.push(d)});const p={origin:{lat:s[n][0].latitude,lng:s[n][0].longitude},destination:{lat:s[n][s[n].length-1].latitude,lng:s[n][s[n].length-1].longitude},waypoints:g,travelMode:google.maps.TravelMode.DRIVING,avoidTolls:!0};m.route(p,(c,d)=>{if(d===google.maps.DirectionsStatus.OK&&c){var f=new google.maps.DirectionsRenderer;f.setMap(t),f.setOptions({suppressMarkers:!0,preserveViewport:!0}),f.setDirections(c);var h=new google.maps.DirectionsRenderer({draggable:!1,map:t,suppressMarkers:!1,preserveViewport:!0,suppressInfoWindows:!0,markerOptions:{icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"white",fillOpacity:1,strokeWeight:3,strokeColor:"blue",scale:5},zIndex:0}});h.addListener("directions_changed",()=>{const C=h.getDirections();C&&J(C)}),h.setDirections(c),e.forEach((C,I)=>{const w=I+1+"",v=T(e[I].arrival_time),_=q(e,w,I,t,v,C.e),y=L(C);o.push(_),_.addListener("click",()=>{r.setContent(y),r.open(t,_)})}),X(e,t,r,o)}else console.error("index: ",n),console.error("parts: ",s),console.error("\uACBD\uB85C \uC694\uCCAD \uC2E4\uD328:",d)})}}function q(e,t,r,o,l,i){const n=r===0?e.length:e.length-r,s=i==1?"red":"black";return new google.maps.Marker({position:new google.maps.LatLng(e[r].latitude,e[r].longitude),map:o,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:l,fillOpacity:1,strokeWeight:2,strokeColor:s,scale:10},label:{text:t},zIndex:n})}function T(e){const t=parseInt(e.split(":")[0]);return t>=0&&t<=11?"#FFA7A7":t>=12&&t<=14?"#FAED7D":t>=15&&t<=17?"#B7F0B1":"#6799FF"}function V(e){const t=Math.floor(e/60),r=e%60;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function j(e){if(e>=1440)return"23:59";{const t=Math.floor(e/60),r=e%60;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}}function L(e){return`
  <strong>- Zipcode: </strong>${e.zip_code}<br>
  <strong>- Customer: </strong>${e.nm_count}<br>
  <strong>- Total Item: </strong>${e.box_count}<br>
  `}function W(e){return`
  (${e.zip_code})<br>
  ${e.address}<br>
  `}function Z(e){return`
  - Arrival Time: ${e.arrival_time}<br>
  - Dwell Time: ${e.dwell_time}<br>
  - Items: ${e.box_num}<br>
  - Total Weight: ${e.order_volume}<br>
  - Requested time from: ${e.open_time}<br>
  - Requested time to: ${e.close_time}<br>
  `}function J(e){let t=0;const r=e.routes[0];if(!!r){for(let o=0;o<r.legs.length;o++)t+=r.legs[o].distance.value;t=t/1e3,document.getElementById("total").innerHTML=t+" km"}}function X(e,t,r,o){const l=document.getElementById("data-list");l&&(l.innerHTML="",e.forEach((i,n)=>{const s=document.createElement("li");s.className="data-item";const a=document.createElement("div");a.className="item-header";const m=document.createElement("div");m.className="index-circle",m.style.backgroundColor=T(e[n].arrival_time);const u=e[n].e==1?"red":"black";m.style.borderColor=u;const g=document.createElement("span");g.textContent=(n+1).toString(),m.appendChild(g);const p=document.createElement("div");p.className="header-info",p.innerHTML=W(i),a.appendChild(m),a.appendChild(p),s.appendChild(a);const c=document.createElement("div");c.innerHTML=Z(i),s.appendChild(c),l.appendChild(s),a.addEventListener("click",()=>{const d=o[n];d&&(o.forEach((f,h)=>{f.setZIndex(o.length-h)}),d.setZIndex(o.length+1),r.setContent(L(i)),r.open(t,d))})}))}const M=document.getElementById("accordian-header"),b=document.querySelector(".arrow-icon"),E=document.getElementById("sidebar");if(M&&b&&E){let e=!0;M.addEventListener("click",()=>{e?(E.style.maxHeight="0",E.addEventListener("transitionend",()=>{E.style.padding="0"},{once:!0})):(E.style.maxHeight="50%",E.style.padding="1rem"),e=!e,b.style.transform=e?"rotate(180deg)":"rotate(0deg)"})}else console.error("Required elements not found");window.initMap=U;
