import"./modulepreload-polyfill.c7c6310f.js";function R(){return fetch("https://api.github.com/repos/ktlisfo/singpost/contents/data/input-data/").then(r=>{if(!r.ok)throw new Error("Failed to fetch file list");return r.json()}).then(r=>{console.log(r);const c=r.map(s=>s.name);return console.log(c),c}).catch(r=>(console.error("Error:",r),[]))}function _(t){return fetch(t).then(e=>{if(!e.ok)throw new Error(`JSON \uC77D\uAE30 \uC624\uB958: ${e.status} ${e.statusText}`);return e.json()}).then(e=>{const n=new Set;return e.result.forEach(r=>{n.add(r.CAR_NUM)}),n})}const g=new Map;function B(t){const e=document.createDocumentFragment();return t.forEach(n=>{const r=n.slice(0,5);if(!g.has(r)){const i=document.createElement("details");i.className="date-details";const o=document.createElement("summary");o.className="date-summary",o.textContent=r;const E=document.createElement("div");E.className="date-item",i.appendChild(E),i.appendChild(o),g.set(r,i)}const c=g.get(r),s=c.querySelector(".date-item"),l=document.createElement("details");l.className="filename-details";const u=document.createElement("summary");u.className="filename-summary",u.textContent=n.replace(".json",""),console.log("fname: "+n),u.addEventListener("click",function(){const i="/singpost/data/input-data/"+n;console.log("jsonUrl: "+i),F.has(n)||(_(i).then(o=>{console.log(o),v(n,o)}).catch(o=>{console.error("JSON \uC77D\uAE30 \uC624\uB958:",o)}),F.add(n))});const a=document.createElement("div");a.className="carname-item";const f="./data/all-route/",m=document.createElement("a");m.className="carname-item";const d=f+n.replace("json","html");console.log("all route url: "+d),m.href=d,m.textContent="All Route",a.appendChild(m);const h="./data/all-route-by-car/"+n.replace(".json","_by_CAR.html");console.log("bycar url: "+h),fetch(h).then(i=>{if(i.ok){const o=document.createElement("a");o.className="carname-item",o.href=h,o.textContent="All Route By Car",a.appendChild(o)}}),l.appendChild(u),l.appendChild(a),s.appendChild(l),e.appendChild(c)}),e}function v(t,e){const n="./route.html?",r=t.replace(".json",""),c=t.slice(0,5),s=document.querySelector(".tree-nav");if(s){const l=s.querySelectorAll(".date-summary");for(const u of l)if(u.textContent===c){const a=u.previousElementSibling;if(console.log(a),a){const f=a.querySelectorAll(".filename-summary");console.log(f);for(const m of f)if(m.textContent===r){const d=m.nextElementSibling;d&&x(e).forEach(p=>{const h=document.createElement("a");h.className="carname-item",h.href=n+"fname="+t.replace(".json","")+"&car_id="+p,h.textContent=p,d.appendChild(h)});break}}}}}function D(t){return t.sort((e,n)=>{const r=N(e),c=N(n);if(r>c)return-1;if(r<c)return 1;const s=C(e),l=C(n);if(s>l)return 1;if(s<l)return-1;const u=s==0?S(e):y(e),a=l==0?S(n):y(n);if(u>a)return-1;if(u<a)return 1;const f=A(e),m=A(n);if(f>m)return-1;if(f<m)return 1;const d=b(e),p=b(n);return d>p?-1:d<p?1:0}),console.log(t),t}function N(t){const[e,n]=[t.substring(0,2),t.substring(2,5)],r={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};return new Date(2023,r[n],parseInt(e))}function C(t){return console.log("E or R: "+t[6]),t[6]=="E"?0:1}function y(t){const e=t.match(/R([0-9]+)/);return e?parseInt(e[1]):0}function S(t){const e=t.match(/E([0-9]+)/);return e?parseInt(e[1]):0}function A(t){const e=t.match(/T([0-9]+)/);return e?parseInt(e[1]):0}function b(t){const e=t.match(/P([0-9]+)/);return e?parseInt(e[1]):0}function x(t){return Array.from(t).sort()}const F=new Set;R().then(t=>{const e=D(t),n=B(e),r=document.querySelector(".tree-nav");r?r.appendChild(n):console.error("Container Element Not Found")}).catch(t=>{console.error("Error:",t)});
