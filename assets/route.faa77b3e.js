import"./modulepreload-polyfill.c7c6310f.js";const k=new URLSearchParams(window.location.search),L=`${k.get("fname")}.json`,O=k.get("car_id");console.log(`fname: ${L}`);console.log(`carID : ${O}`);async function W(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`JSON \uC77D\uAE30 \uC624\uB958: ${t.status} ${t.statusText}`);return(await t.json()).result.filter(n=>n.CAR_NUM===O).map(n=>{const{VISIT_ORDER:d,Y:m,X:o,ZIP_CODE:s,ADDRESS_FULL:i,OPEN_TIME:v,CLOSE_TIME:u,ORDER_VOLUME:I,BOX_NUM:c,OPT_ARR_TIME_HM:l,EST_PROC_TIME:g,NM_COUNT:p,BOX_COUNT:C,E:f,PLACE_ID:_}=n,E=parseInt(d),y=parseFloat(m),a=parseFloat(o),h=s,B=i,M=z(parseInt(v)),b=Y(parseInt(u)),D=parseFloat(I),F=parseInt(c),N=l,x=parseInt(g),A=parseInt(p),H=parseInt(C),P=parseInt(f);return{visit_order:E,latitude:y,longitude:a,zip_code:h,address:B,open_time:M,close_time:b,order_volume:D,box_num:F,arrival_time:N,dwell_time:x,nm_count:A,box_count:H,e:P,place_id:_}})}catch(t){return console.error("JSON \uC77D\uAE30 \uC624\uB958:",t),[]}}async function X(){const e=new google.maps.Map(document.getElementById("map"),{zoom:4}),t=new google.maps.InfoWindow,r=[];try{const n=await W(`/singpost/data/input-data/${L}`);n.length>0?U(n,e,t,r):console.error("\uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.")}catch(n){console.error("\uB370\uC774\uD130 \uB85C\uB529 \uC624\uB958:",n)}}function U(e,t,r,n){var d=e.map(function(c){return c.longitude}),m=e.map(function(c){return c.latitude});t.fitBounds({west:Math.min.apply(null,d),east:Math.max.apply(null,d),north:Math.min.apply(null,m),south:Math.max.apply(null,m)});for(var o=0,s=[],i=25-1;o<e.length;o=o+i)s.push(e.slice(o,o+i+1));function v(c){return c.place_id?{location:{placeId:c.place_id}}:u(c)}function u(c){return{location:new google.maps.LatLng(c.latitude,c.longitude)}}function I(c,l,g,p){const C={origin:l,destination:g,waypoints:p,travelMode:google.maps.TravelMode.DRIVING,avoidTolls:!0};c.route(C,(f,_)=>{if(_===google.maps.DirectionsStatus.OK&&f){var E=new google.maps.DirectionsRenderer;E.setMap(t),E.setOptions({suppressMarkers:!0,preserveViewport:!0}),E.setDirections(f);var y=new google.maps.DirectionsRenderer({draggable:!1,map:t,suppressMarkers:!1,preserveViewport:!0,suppressInfoWindows:!0,markerOptions:{icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"white",fillOpacity:1,strokeWeight:3,strokeColor:"blue",scale:5},zIndex:0}});y.addListener("directions_changed",()=>{const a=y.getDirections();a&&Z(a)}),y.setDirections(f),e.forEach((a,h)=>{const B=h+1+"",M=R(e[h].arrival_time),b=q(e,B,h,t,M,a.e),D=$(a);n.push(b),b.addListener("click",()=>{r.setContent(D),r.open(t,b)})}),J(e,t,r,n)}else console.error("index: ",o),console.error("parts: ",s),console.error("\uACBD\uB85C \uC694\uCCAD \uC2E4\uD328:",_)})}for(var o=0;o<s.length;o++){const l=[],g=[];s[o].slice(1,e.length-1).forEach(a=>{l.push(v(a)),g.push(u(a))});const p=new google.maps.DirectionsService,C={placeId:s[o][0].place_id},f={placeId:s[o][s[o].length-1].place_id},_=u(s[o][0]),E=u(s[o][s[o].length-1]);l.every(a=>{if(a&&"location"in a){const h=a.location;if(typeof h=="object"&&"placeId"in h)return!0}return!1})?(I(p,C,f,l),console.log("Routing with placeID")):(I(p,_,E,g),console.log("Routing with XY"))}}function q(e,t,r,n,d,m){const o=r===0?e.length:e.length-r,s=m==1?"blue":"black";return new google.maps.Marker({position:new google.maps.LatLng(e[r].latitude,e[r].longitude),map:n,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:d,fillOpacity:1,strokeWeight:3,strokeColor:s,scale:10},label:{text:t},zIndex:o})}function R(e){const t=parseInt(e.split(":")[0]);return t>=0&&t<=11?"#FFA7A7":t>=12&&t<=14?"#FAED7D":t>=15&&t<=17?"#B7F0B1":"#6799FF"}function z(e){const t=Math.floor(e/60),r=e%60;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function Y(e){if(e>=1440)return"23:59";{const t=Math.floor(e/60),r=e%60;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}}function $(e){return`
  <strong>- Zipcode: </strong>${e.zip_code}<br>
  <strong>- Customer: </strong>${e.nm_count}<br>
  <strong>- Total Item: </strong>${e.box_count}<br>
  `}function j(e){return`
  (${e.zip_code})<br>
  ${e.address}<br>
  `}function V(e){return`
  - Arrival Time: ${e.arrival_time}<br>
  - Dwell Time: ${e.dwell_time}<br>
  - Items: ${e.box_num}<br>
  - Total Weight: ${e.order_volume}<br>
  - Requested time from: ${e.open_time}<br>
  - Requested time to: ${e.close_time}<br>
  `}function Z(e){let t=0;const r=e.routes[0];if(!!r){for(let n=0;n<r.legs.length;n++)t+=r.legs[n].distance.value;t=t/1e3,document.getElementById("total").innerHTML=t+" km"}}function J(e,t,r,n){const d=document.getElementById("data-list");d&&(d.innerHTML="",e.forEach((m,o)=>{const s=document.createElement("li");s.className="data-item";const i=document.createElement("div");i.className="item-header";const v=e[o].e==1?"#EBF7FF":"#EEEEEE";i.style.backgroundColor=v;const u=document.createElement("div");u.className="index-circle",u.style.backgroundColor=R(e[o].arrival_time);const I=e[o].e==1?"blue":"black";u.style.borderColor=I;const c=document.createElement("span");c.textContent=(o+1).toString(),u.appendChild(c);const l=document.createElement("div");l.className="header-info",l.innerHTML=j(m),i.appendChild(u),i.appendChild(l),s.appendChild(i);const g=document.createElement("div");g.innerHTML=V(m),s.appendChild(g),d.appendChild(s),i.addEventListener("click",()=>{const p=n[o];p&&(n.forEach((C,f)=>{C.setZIndex(n.length-f)}),p.setZIndex(n.length+1),r.setContent($(m)),r.open(t,p))})}))}const S=document.getElementById("accordian-header"),T=document.querySelector(".arrow-icon"),w=document.getElementById("sidebar");if(S&&T&&w){let e=!0;S.addEventListener("click",()=>{e?(w.style.maxHeight="0",w.addEventListener("transitionend",()=>{w.style.padding="0"},{once:!0})):(w.style.maxHeight="50%",w.style.padding="1rem"),e=!e,T.style.transform=e?"rotate(180deg)":"rotate(0deg)"})}else console.error("Required elements not found");window.initMap=X;
